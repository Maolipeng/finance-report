(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[4],{190:function(e,t){},455:function(e,t){},456:function(e,t){},466:function(e,t,n){"use strict";n.r(t);n(71);var a=n(73),r=(n(86),n(95)),o=n(194),c=n(0),i=n.n(c),l=n(460),u=n(188),s=n.n(u),f=n(191),p=n(192);function h(){var e=Object(f.a)(["\n  .excel-upload-input {\n    display: none;\n    z-index: -9999;\n  }\n  .drop {\n    border: 2px dashed #bbb;\n    width: 600px;\n    height: 160px;\n    line-height: 160px;\n    margin: 0 auto;\n    font-size: 24px;\n    border-radius: 5px;\n    text-align: center;\n    color: #bbb;\n    position: relative;\n  }\n"]);return h=function(){return e},e}var d=p.a.div(h()),m=function(e){var t=e.beforeUpload,n=e.onSuccess,r=Object(c.useState)([]),l=Object(o.a)(r,2),u=(l[0],l[1]),f=Object(c.useState)({}),p=Object(o.a)(f,2),h=(p[0],p[1]),m=Object(c.useRef)(null),g=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result,a=s.a.read(n,{type:"array"}),r=a.SheetNames[0],o=a.Sheets[r],c=b(o),i=s.a.utils.sheet_to_json(o);y({header:c,results:i}),t()},a.readAsArrayBuffer(e)}))},v=function(e){(m.current.files=null,t)?g(e):(t(e)&&g(e),g(e))},b=function(e){var t,n=[],a=s.a.utils.decode_range(e["!ref"]),r=a.s.r;for(t=a.s.c;t<=a.e.c;++t){var o=e[s.a.utils.encode_cell({c:t,r:r})],c="UNKNOWN "+t;o&&o.t&&(c=s.a.utils.format_cell(o)),n.push(c)}return n},y=function(e){var t=e.header,a=e.results,r={};r.header=t,r.results=a,console.log("excelData",r),h(r),n&&n(r)};return i.a.createElement(d,null,i.a.createElement("input",{ref:m,className:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:function(){if(console.log("inputFileRef.current.files",m.current.files),m.current.files.length){u(m.current.files);var e=m.current.files[0];v(e)}}}),i.a.createElement("div",{className:"drop"},"Drop excel file here or",i.a.createElement(a.a,{type:"primary",onClick:function(){m.current.click()}},"Browse")))},g=n(461),v=n(459);function b(e,t){for(var n,a={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=e.length;++o)for(var c=0;c!=e[o].length;++c){r.s.r>o&&(r.s.r=o),r.s.c>c&&(r.s.c=c),r.e.r<o&&(r.e.r=o),r.e.c<c&&(r.e.c=c);var i={v:e[o][c]};if(null!=i.v){var l=s.a.utils.encode_cell({c:c,r:o});"number"===typeof i.v?i.t="n":"boolean"===typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=s.a.SSF._table[14],i.v=(n=i.v,void 0&&(n+=1462),(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):i.t="s",a[l]=i}}return r.s.c<1e7&&(a["!ref"]=s.a.utils.encode_range(r)),a}function y(){if(!(this instanceof y))return new y;this.SheetNames=[],this.Sheets={}}function x(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}function S(){var e=Object(f.a)(["\n  width: 100%;\n  height: 100%;\n  .header {\n    width: 300px;\n    margin: 10px auto;\n  }\n  .upload-container {\n    width: 100%;\n    margin-top: 50px;\n  }\n  .handle-area {\n    margin-top: 50px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n"]);return S=function(){return e},e}var w=p.a.div(S()),j=[];t.default=function(e){var t=Object(c.useState)("export-list"),n=Object(o.a)(t,2),u=n[0],f=n[1],p=Object(c.useState)(null),h=Object(o.a)(p,2),d=h[0],S=h[1],O=Object(c.useState)([]),E=Object(o.a)(O,2),N=E[0],D=E[1],C=Object(c.useState)(""),k=Object(o.a)(C,2),_=k[0],A=(k[1],Object(c.useState)({})),R=Object(o.a)(A,2),T=R[0],z=R[1],U=function(e){var t=Object.keys(e);return j.filter((function(n){return t.every((function(t){return"current"===t||"pageSize"===t||e[t]===n[t]}))}))},B=function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?function(e,t){if(0===arguments.length||!e)return null;var n,a=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===typeof e?n=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var r={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},o=a.replace(/{([ymdhisa])+}/g,(function(e,t){var n=r[t];return"a"===t?["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][n]:n.toString().padStart(2,"0")}));return o}(t[e]):t[e]}))}))};return i.a.createElement(w,null,i.a.createElement("h1",{className:"header"},"Report Excel Tool"),i.a.createElement("div",{className:"upload-container"},i.a.createElement(m,{onSuccess:function(e){console.log("excelData1",e);var t=e.header,n=e.results,a=t.map((function(e){return{title:e,dataIndex:e,copyable:!0}}));console.log("headerColumns",a),a,D(a),j=n,S(n)},beforeUpload:function(e){return console.log("files",e),!0}})),i.a.createElement("div",{className:"handle-area"},"\u5bfc\u51fa\u6587\u4ef6\u540d\u5b57\uff1a",i.a.createElement(r.a,{value:u,style:{width:"200px",marginRight:"100px"},onChange:function(e){return f(e.target.value)}}),i.a.createElement(a.a,{type:"primary",disabled:!(d&&d.length),onClick:function(){var e=N.map((function(e){return e.title})),t=Object.keys(T).map((function(t){return e[t]}));console.log("HideColumns",t);var n=e.filter((function(e){return!t.includes(e)}));!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.multiHeader,n=void 0===t?[]:t,a=e.header,r=e.data,o=e.filename,c=e.merges,i=void 0===c?[]:c,l=e.autoWidth,u=void 0===l||l,f=e.bookType,p=void 0===f?"xlsx":f;o=o||"excel-list",(r=Object(g.a)(r)).unshift(a);for(var h=n.length-1;h>-1;h--)r.unshift(n[h]);var d="SheetJS",m=new y,S=b(r);if(i.length>0&&(S["!merges"]||(S["!merges"]=[]),i.forEach((function(e){S["!merges"].push(s.a.utils.decode_range(e))}))),u){for(var w=r.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),j=w[0],O=1;O<w.length;O++)for(var E=0;E<w[O].length;E++)j[E].wch<w[O][E].wch&&(j[E].wch=w[O][E].wch);S["!cols"]=j}m.SheetNames.push(d),m.Sheets[d]=S;var N=s.a.write(m,{bookType:p,bookSST:!1,type:"binary"});Object(v.saveAs)(new Blob([x(N)],{type:"application/octet-stream"}),"".concat(o,".").concat(p))}({header:n,data:B(n,d),filename:u,autoWidth:!0})}},"\u5bfc\u51faExcel")),i.a.createElement("div",{className:"table-list"},d&&i.a.createElement(l.a,{className:"App",size:"small",columns:d&&N,rowKey:"\u5408\u540c\u7f16\u53f7",params:_,columnsStateMap:T,onColumnsStateChange:function(e){return function(e){console.log("map",e),z(e)}(e)},request:function(e){console.log("params",e);var t=U(e);return new Promise((function(e,n){console.log("tableData",d),setTimeout((function(){e({data:t,success:!0})}),1e3)}))},postData:function(e){return S(e),e}})))}}}]);
//# sourceMappingURL=4.356e5f21.chunk.js.map